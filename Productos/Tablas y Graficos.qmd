---
title: "Graficos y Tablas"
format: html
editor: visual
---

```{r}

```

```{r}
ggplot() + geom_point(aes(x=años,y=ganados)) + scale_y_continuous(limits = c(0,30)) + scale_x_continuous(breaks = seq(2009,2020,1))+labs(title = "Partidos Ganados UC", subtitle = "Entre los años 2009 y 2020", y = "Partidos Ganados", x = "Años",caption = "Promedio de Partidos por año: 34") + theme_bw()
```

```{r}
tabla <- data.frame(años,ganados,empatados,perdidos,totales) %>%
  gt() %>% 
  tab_header(title = "Rendimiento Universidad Catolica",subtitle = "Entre los años 2009 y 2020") %>% 
  tab_spanner(label = "Partidos",columns = 2:5) 
  
tabla
```

```{r}
ggplot() + geom_point(aes(x=años,y=ganados)) + scale_y_continuous(limits = c(0,30)) + scale_x_continuous(breaks = seq(2009,2020,1))+labs(title = "Partidos Ganados Colo-Colo", subtitle = "Entre los años 2009 y 2020", y = "Partidos Ganados", x = "Años",caption = "Promedio de Partidos por año: 34") + theme_bw()
```

```{r}
tabla <- data.frame(años,ganados,empatados,perdidos,totales) %>%
  gt() %>% 
  tab_header(title = "Rendimiento Colo-Colo",subtitle = "Entre los años 2009 y 2020") %>% 
  tab_spanner(label = "Partidos",columns = 2:5) 
  
tabla
```

```{r}
ggplot() + geom_point(aes(x=años,y=ganados)) + scale_y_continuous(limits = c(0,30)) + scale_x_continuous(breaks = seq(2009,2020,1))+labs(title = "Partidos Ganados U. De Chile", subtitle = "Entre los años 2009 y 2020", y = "Partidos Ganados", x = "Años",caption = "Promedio de Partidos por año: 34") + theme_bw()
```

```{r}
tabla <- data.frame(años,ganados,empatados,perdidos,totales) %>%
  gt() %>% 
  tab_header(title = "Rendimiento Colo-Colo",subtitle = "Entre los años 2009 y 2020") %>% 
  tab_spanner(label = "Partidos",columns = 2:5) 
  
tabla
```

## Tablas de enfrentamiento directo en los tres equipos más populares de Chile

Partiremos con Colo-Colo vs Universidad Catolica

```{r}
ccvsuc <- Datos %>% 
  filter(HT == "Colo Colo", AT == "Universidad Catolica")
ucvscc <- Datos %>% 
  filter(HT == "Universidad Catolica",AT == "Colo Colo")

re <- puntos(ccvsuc)
er <- puntos(ucvscc)

Partidos<- c(re[4] + er[6],re[5] + er[5],re[6] + er[4])
cc <- c("Ganados CC", "Empatados", "Ganados UC")
tabla <- data.frame(cc,Partidos) %>% gt() %>% 
  tab_header(title = "Enfrentamientos directos CC vs Uc",subtitle = "Entre los años 2009 y 2020")
tabla
```

El segundo enfrentamiento a analizar es el denominado Superclasico del fútbol chileno, Colo-Colo vs U. de Chile

```{r}
ccvsu <- Datos %>% 
  filter(HT == "Colo Colo", AT == "Universidad de Chile")
uvscc <- Datos %>% 
  filter(HT == "Universidad de Chile",AT == "Colo Colo")

ucc <- puntos(ccvsu)
ccu <- puntos(uvscc)

Partidos <- c(ucc[4] + ccu[6],ucc[5] + ccu[5],ucc[6] + ccu[4])
cu <- c("Ganados CC", "Empatados", "Ganados U")
tabla2 <- data.frame(cu,Partidos) %>% gt() %>% tab_header(title = "Enfrentamientos directos CC vs U",subtitle = "Entre los años 2009 y 2020")
tabla2
```

Por último veremos los enfrentamientos entre Universidad de Chile vs Universidad Catolica, el denominado clasico universitario.

```{r}
ucvsu <- Datos %>% 
  filter(HT == "Universidad Catolica", AT == "Universidad de Chile")
uvsuc <- Datos %>% 
  filter(HT == "Universidad de Chile",AT == "Universidad Catolica")

ucu <- puntos(ucvsu)
uuc <- puntos(uvsuc)

Partidos <- c(ucu[4] + uuc[6],ucu[5] + uuc[5],ucu[6] + uuc[4])
uc <- c("Ganados UC", "Empatados", "Ganados U")
tabla3 <- data.frame(uc,Partidos) %>% gt() %>% tab_header(title = "Enfrentamientos directos UC vs U",subtitle = "Entre los años 2009 y 2020")
tabla3
```
